<!doctype html><html><head><title>Memory mountain - DemoHut</title><link rel="shortcut icon" href="/demohut/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/demohut/main.css"><meta charset="UTF-8"></head><body><a class="github-corner" href="https://github.com/ZhujinLi/demohut-src/tree/master/src/subjs/subj-mem" target="_blank" aria-label="View source on GitHub"><svg width="96" height="96" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a><div class="jumbotron jumbotron-fluid text-monospace" id="jumbotron"><div class="container" style="position: relative"><h1><a href="/demohut/">DemoHut</a></h1></div></div><div class="container"><form class="text-right" action="/demohut/"><button class="btn btn-outline-primary" type="submit">‚Üê all posts</button></form><div class="display-4"><p>Memory mountain</p></div><div id="content"><p>A live demo of <a href="http://csappbook.blogspot.com/2017/05/a-gallery-of-memory-mountains.html" target="_blank">memory mountain</a>.</p><blockquote class="blockquote"><p>The memory mountain shows the throughput achieved by a program repeatedly reading elements from an array of N elements, using a stride of S (i.e., accessing elements 0, S, 2S, 3S, ..., N-1). The performance, measured in megabytes (MB) per second, varies according to how many of the elements are found in one of the processor's caches. For small values of N, the elements can be held in the L1 cache, achieving maximum read throughput. For larger values of N, the elements can be held in the L2 cache, and the L1 cache may be helpful for exploiting spatial locality for smaller values of S. For large values of N, the elements will reside in main memory, but both the L1 and L2 cache can improve performance when S enables some degree of spatial locality.</p></blockquote><p><a href="http://csapp.cs.cmu.edu/3e/perspective.html" target="_blank">More illustrations...</a></p><div id="plot"></div><div class="sub-title">Implementation notes</div><ul><li><p>The result is heavily dependant on the browser's JavaScript engine, unlike the original C implementation, where in-depth low-level optimization is guaranteed. I obtained the best result with Chrome on my Mac, from which L1-L2-L3-DRAM hierarchy can be seen distinctly:</p><img src="./chrome_mac.png" width="400"></li><li><p>The original C implementation defaults to a CPU clock measurement using x86 Time Stamp Counter (TSC), which again is not possible on the browser (even with WebAssembly). So I take an alternative approach based on time measurement function <i>performance.now()</i>, which claims to provide sub-milliseconds resolution. Unfortunately, most browsers nowadays have reduced the time precision by a large margin, in order to prevent timing attacks and fingerprinting. I have no other options but to repeat a great deal of times for a decent result, and that's why it's running a little bit slower.</p></li></ul><script src="/demohut/libs/plotly-1.58.4.min.js"></script><script src="./subj-mem.js"></script></div><div class="hr-theme-slash-2"><div class="hr-line l"></div><div class="hr-icon"><a href="https://ZhujinLi.github.io"><img src="/demohut/res/home.png" height="28px"></a></div><div class="hr-line r"></div></div><p class="text-center text-secondary" style="font-size: 15px">All demos have been tested on Microsoft Edge/macOS.</p></div><script src="/demohut/main.js"></script></body></html>